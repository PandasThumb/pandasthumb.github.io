<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shannon entropy applied</title>
  
  <meta property="og:site_name" content="The Panda's Thumb" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Shannon entropy applied" />
  <meta property="og:url" content="https://pandasthumb.org/archives/2004/05/shannon-entropy.html" />
  <meta property="og:image" content="https://pandasthumb.org/media/roar.jpg" />
  <meta property="article:author" content="PvM" />
  <meta property="article:published_time" content="2004-05-27T21:06:09-07:00" />


  <link rel="stylesheet" type='text/css' href="/css/normalize.css" />
  <link rel="stylesheet" type='text/css' href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,400italic,700italic|Source+Code+Pro:400,700" />
  <link rel="stylesheet" type='text/css' href="/css/gridism.css" />
  <link rel="stylesheet" type='text/css' href="/css/style.css" />
  <link rel="stylesheet" type='text/css' href="/css/github.css" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <script type="text/javascript" src="//code.jquery.com/jquery-3.1.1.min.js"></script>
  <script type="text/javascript" src="https://use.fontawesome.com/e6a24c6dde.js"></script>
  <script type="text/javascript" async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>  
  <script src="/js/local.js"></script>

</head>


<body class="wrap">
  <div class="grid page-fill"><div></div></div>
<header class="topbar">
  <div class="grid no-gutters">
    <div class="banner unit whole">
		  <img src="/media/banner.jpg" alt="The Panda's Thumb" />
    </div>
    <nav class="main-nav unit whole align-center">
      <ul>
<li><a href="/" title="Main Page"><i class="fa fa-home" aria-hidden="true"></i>&nbsp;Main</a></li>
<li><a href="/archives/index.html" title="Archives"><i class="fa fa-book" aria-hidden="true"></i>&nbsp;Archives</a></li>
<li><a href="/search.html" title="Searching Panda's Thumb"><i class="fa fa-book" aria-hidden="true"></i>&nbsp;Search</a></li>
</ul>

    </nav>
  </div>
</header>


    <section class="blog">
    <div class="grid">
      <div class="unit whole">
        <article class="blogpost">
  <header>
	  <h1><a href="/archives/2004/05/shannon-entropy.html">Shannon entropy applied</a></h1>
	  <div class="byline"><i class="fa fa-user-circle" aria-hidden="true"></i> By PvM</div>
	  <div class="attrline"><i class="fa fa-clock-o" aria-hidden="true"></i>
	  <span><time pubdate="pubdate" datetime="2004-05-27T21:06:09-07:00">May 27, 2004 21:06 MST</time></span>
	  </div>
   </header>
  <h2 id="introduction-to-shannon-entropy">Introduction to Shannon entropy</h2>

<p>Motivated by what I perceive to be a deep misunderstanding of the concept of entropy I have decided to take us onto a journey into the world of entropy. Recent confusions as to how to calculate entropy for mutating genes have will be addressed in some detail.</p>

<p>I will start with referencing Shannon’s seminal paper on entropy and slowly  expand the discussion to include the formulas relevant for calculating the  entropy in the genome.</p>

<p>But first some warnings</p>

<ul>
  <li><a href="http://www.lecb.ncifcrf.gov/~toms/information.is.not.uncertainty.html">Information Is Not Entropy, Information Is Not Uncertainty! </a></li>
  <li><a href="http://www.lecb.ncifcrf.gov/~toms/pitfalls.html">Pitfalls in information theory</a></li>
</ul>

<p>Okay, now that I have given these useful warnings lets have a look Shannon’s paper.</p>

<p><a href="http://cm.bell-labs.com/cm/ms/what/shannonday/shannon1948.pdf">“A Mathematical Theory of Communication”</a>, Reprinted with corrections from The Bell System Technical Journal, Vol. 27, pp. 379-423, 623-656, July, October, 1948. By C. E. SHANNON</p>

<p>Suppose we have a set of \(n\) possible events with probability \((p_1,...p_n)\) the  entropy for such a situation is defined by:</p>

\[H = - \sum_{i} p_i \log(p_i)\]

<p>I will apply this formula to a simplified example in which there are two events with probability p and q where q=(1-p) since the sum of the probabilities adds up to 1. Theh entropy in the case of two possibilities with probabilities p and q = 1 is given by:</p>

\[H(p) = -(p \log p + (1-p) \log (1-p))\]

<p><img src="/uploads/2005/entropy.jpg" alt="" /></p>

<blockquote>
  <p>Figure 1: Entropy for a system with two states. The horizontal axis describes the probability p and the vertical axis the entropy \(H(p)\) as calculated using the formula above</p>
</blockquote>

<p>Some important observations:</p>

<ul>
  <li>Entropy is zero when probability for p=0 or p=1</li>
  <li>Entropy is maximum when p=q=0.5</li>
</ul>

<p>Observation 1 can be expressed more generally by observing that if the probability for any one of the variables is 1 that the entropy is minimal.</p>

<p>Observation 2 can be made more universal by observing that the entropy for n  variables is maximum when \(p_i=1/n\) or in other words, a uniform distribution.</p>

<h2 id="extending-shannon-entropy-to-the-genome">Extending Shannon entropy to the genome</h2>

<p>Various people have taken the work by Shannon and applied it, quite succesfully, to the genome.</p>

<p>Tom Schneider’s <a href="http://www.lecb.ncifcrf.gov/~toms/">website</a> contains a paper called <a href="http://www.lecb.ncifcrf.gov/~toms/paper/ev/">evolution of biological information</a> which shows how to apply Shannon entropy to entropy calculcations for the genome. In addition Schneider provides us with a more in-depth introduction into <a href="http://www.lecb.ncifcrf.gov/~toms/paper/primer/">Information theory</a>.</p>

<p>For those interested in how to correctly apply entropy calculations to the genome, I refer to the excellent <a href="http://www.lecb.ncifcrf.gov/~toms/introduction.html">introduction</a> by Tom Schneider.</p>

<p>Schneider has succesfully applied Shannon entropy to <a href="http://www.lecb.ncifcrf.gov/~toms/paper/flexrbs/">identify</a> and predict <a href="http://www.lecb.ncifcrf.gov/~pnh/papers/poster/ucb.htm">binding sites</a></p>

<p>Some successes include:</p>

<p>N. D. Herman and T. D. Schneider, <a href="http://www.lecb.ncifcrf.gov/~toms/paper/fincd/">High Information Conservation Implies that at Least Three Proteins Bind Independently to F Plasmid incD Repeats</a>, J. Bact., 174, 3558-3560, 1992.</p>

<p>T. D. Schneider and G. D. Stormo, Excess Information at Bacteriophage T7 Genomic Promoters Detected by a Random Cloning Technique, Nucl. Acids Res., 17, 659-674, 1989.</p>

<p>Schneider’s 1997 paper <a href="http://www.lecb.ncifcrf.gov/~toms/paper/ri/latex/paper.pdf">Information content of individual genetic sequences</a> published in J. Theor. Biol. 189(4): 427-441, 1997 shows an example of application of Shannon entropy.</p>

<p>Now we can extend this using Adami’s 2002 paper Adami C. (2002) <a href="http://www.krl.caltech.edu/~adami/BE2002.pdf">“What is complexity?</a>”, BioEssays 24, 1085-1094.</p>

<blockquote>
  <p>The entropy of an ensemble of sequences X, in which sequences \(s_i\) occur with probabilities \(p_i\) is calculated as</p>

\[H(X) = - \sum_{i=1} p_i \log p_i\]

  <p>where the sum goes over all different genotypes i in X. By setting the base of the logarithm to the size of the monomer alphabet, the maximal entropy (in the absence of selection) is given by \(H_{max}(X) = L\) , and in fact corresponds to  the maximal information that can potentially be stored in a sequence of  length L. The amount of information a population X stores about the  environment E is now given by:</p>

\[I(X:E)= H_{max} - H(X|E) = L + \sum_{i=1} p_i \log p_i\]

  <p>The entropy of an ensemble of sequences is estimated by summing up the entropy at every site along the sequence. The per-site entropy is given by:</p>

\[H(j) = - \sum_{i=(A,C,T,G)} p_i(j) \log p_i(j)\]

  <p>for site j, where \(p_i(j)\) denotes the probability to find nucleotides i at position j. The entropy is now approximated by the sum of per-site entropies:</p>

\[H(X) = \sum_{j} H(j)\]

  <p>so that an approximation for the physical complexity of a population of sequences with length L is obtained by</p>

\[C(X) = L - H(X)\]
</blockquote>

<p>Adapted from: <a href="http://info.tuwien.ac.at/tubiomed/dept/rattay/CSSS03_complexity_MTEs.pdf">Does complexity always increase during major evolutionary transitions?</a></p>

<p>From this it should be obvious that \(H(j)\) is zero when a particular mutation becomes fixated in the genome since one of the probabilities will be 1 and the others zero.</p>

<p>For those who wonder:  \(\lim \limits_{p \to 0} p \log p = 0\)</p>

<p>Schneider has some interesting results which show what happens to the entropy in the genome with and <a href="http://www.lecb.ncifcrf.gov/~toms/paper/ev/noselection/">No selection</a>. It should be obious that, not surprisingly, the information remains constant around zero.</p>

<p><img src="http://www.lecb.ncifcrf.gov/~toms/paper/ev/talk/images/ev.curves.jpg" alt="" height="400" /></p>

<p>Figure 2 (from Schneider’s <a href="http://www.lecb.ncifcrf.gov/~toms/paper/ev/talk/">talk</a>): Notice how the information in the genome increases under selection but disappears once selective constraints are removed. 
<a href="http://www.lecb.ncifcrf.gov/~toms/paper/ev/dembski/claimtest.html">Once selection is added</a>, the information quickly approaches the theoretical values</p>

<h2 id="from-jerrys-to-shannon">From Jerry’s to Shannon</h2>

<p>Jerry’s entropy \(S = \log W\) using the following transformations</p>

<p>For the human genome we look at a particular location and observe over many samples and we find \(N_A\), \(N_C\), \(N_T\) and \(N_G\), we calculate the total number of states to be:</p>

\[W = \frac{(N_A+N_C+N_T+N_G)!}{N_A!N_C!N_G!N_T!}\]

<p>using Stirling’s approximation \(\log M! = M(\log M -1)\) we find</p>

\[W = -N (p_A \log p_A + p_C \log p_C + p_G \log p_G + p_T \log p_T)\]

<p>where</p>

\[p_A = \frac{N_A}{N_A+N_C+N_T+N_G}\]

<p>and</p>

\[p_C = \frac{N_C}{N_A+N_C+N_T+N_G}\]

<p>and</p>

\[p_T = \frac{N_T}{N_A+N_C+N_T+N_G}\]

<p>and</p>

\[p_G = \frac{N_G}{N_A+N_C+N_T+N_G}\]

<p>Remember that entropy is a <a href="http://www.realtime.net/~drwolf/papers/dissertation/node12.html">statistical</a> property. See also <a href="http://www.mdpi.net/entropy/papers/e3010001.pdf">this paper</a></p>

<p><a href="http://www.swif.uniba.it/lei/foldop/foldoc.cgi?QED+-+quod+erat+demonstrandum">QED</a></p>

<h2 id="some-relevant-papers">Some relevant papers</h2>

<p><a href="http://www.pnylab.com/pny/papers/cdna/cdna/index.html">“Significantly Lower Entropy Estimates for Natural DNA Sequences”</a>, David Loewenstern, Journal of Computational Biology (under revision)</p>

<p>Abstract wrote:</p>

<blockquote>
  <p>Abstract: If DNA were a random string over its alphabet  {A,C,G,T}, an optimal code would assign 2 bits to each nucleotide. We imagine DNA to be a highly ordered, purposeful molecule, and might therefore  reasonably expect statistical models of its string representation to produce much lower entropy estimates. Surprisingly this has not been the case for many natural DNA sequences, including portions of the human genome. We introduce a new statistical model (compression algorithm), the strongest reported to date, for naturally occurring DNA sequences. Conventional techniques code a nucleotide using only slightly fewer bits (1.90) than one  obtains by relying only on the frequency statistics of individual nucleotides (1.95). Our method in some cases increases this gap by more than five-fold (1.66) and may lead to better performance in microbiological pattern recognition applications.</p>

  <p>One of our main contributions, and the principle source of these  improvements, is the formal inclusion of inexact match information in the model. The existence of matches at various distances forms a panel of experts which are then combined into a single prediction. The structure of this combination is novel and its parameters are learned using Expectation Maximization (EM).</p>

  <p>Experiments are reported using a wide variety of DNA sequences andcompared whenever possible with earlier work. Four reasonable notions for the string 
distance function used to identify near matches, are implemented and experimentally compared.</p>

  <p>We also report lower entropy estimates for coding regions extracted from a large collection of non-redundant human genes. The conventional estimate is 1.92 bits. Our model produces only slightly better results (1.91 bits) when considering nucleotides, but achieves 1.84-1.87 bits when the prediction problem is divided into two stages: i) predict the next amino acid based on inexact polypeptide matches, and ii) predict the particular codon. Our results suggest that matches at the amino acid level play some role, but a small one, in determining the statistical structure of non-redundant coding sequences.</p>
</blockquote>

<p><a href="http://www.math.psu.edu/gunesch/Entropy/bio.html">Entropy in biological sciences</a></p>

<p><a href="http://www.klab.caltech.edu/~ma/cclub/AdamiCClub.ppt"> Adaptation and organism complexity (Chris Adami) </a></p>

<p><a href="http://www.klab.caltech.edu/~ma/cclub/Adami200311.ppt">Using Molecular Evolution and Information Theory to Improve Drug</a></p>

<p><a href="http://www.klab.caltech.edu/~ma/cclub/">Complexity Club at Caltech</a></p>

<p><a href="http://www.cds.caltech.edu/~doyle/CmplxNets/">Introductory and Review papers</a></p>

</article>

      </div>

   
<div id="disqus_thread" class="unit whole"></div>
<script>
var disqus_config = function () {
this.page.url = 'https://pandasthumb.org/archives/2004/05/shannon-entropy.html';
this.page.identifier = '/archives/2004/05/shannon-entropy';
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//the-pandas-thumb.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



    </div>
  </section>


  <footer>
<div class="grid">
<table bgcolor="204517">
<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td>
  <div align="left">
    <p>&nbsp;&nbsp;To see earlier posts, select the Archives at the top of this page</p>
    <p></p>
  </div>
  <div id="RecentComments" class="dsq-widget">
      <div align="center">
       <h2>Recent Comments</h2>
       <P>
       To see the comment in context of the discussion click on the text that indicates how long ago the comment was posted, such as "2 hours ago".  Then wait for the post 
     and then the comments to load (may take many seconds).  The comment should have a gray vertical bar to the left of the commenter's avatar.
      <P>
    </div>
    <div>
     <script type="text/javascript" src="https://the-pandas-thumb.disqus.com/recent_comments_widget.js?num_items=99&hide_mods=0&hide_avatars=0&avatar_size=32&excerpt_length=100"></script>
    </div>
  </div>
</td></tr>
  <tr><td></td><td><div class="unit whole">
      <p>Copyright &copy; The Panda&#8217;s Thumb and original authors &mdash; Content provided under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons BY-NC-ND License 4.0</a>.</p>
    <p></p>
    </div>
    </td></tr>
  </table>
  </div>
  </footer>

  

</body>

</html>


